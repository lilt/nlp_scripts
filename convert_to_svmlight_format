#!/usr/bin/env ruby

require 'zipf'

fd = Marshal.load ReadFile.read ARGV[0]
d = fd.size

not_quiet = ARGV[1]
train = []
l_i = 1
while line = STDIN.gets
  STDERR.write "#{l_i}\n" if l_i%1000==0&&not_quiet
  s = []
  line.split.each { |i|
    k,w = i.split '=', 2
    s << [fd[k]+1, w.to_f]
  }
  s.sort_by! { |i| i.first }
  puts "+1 #{s.map{|i| "#{i.first}:#{i[1]}" }.join(' ')}"
  l_i+= 1
end

